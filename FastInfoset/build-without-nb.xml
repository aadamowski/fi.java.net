<project name="FastInfoset" default="dist" basedir=".">

	<property name="version" value="0.1"/>
        
	<property name="app.jar" value="${ant.project.name}.jar"/>

	<property name="jsr173_api.jar" value="lib/jsr173_api.jar"/>

        <property name="build.dir" value="build" />
        <property name="dist.dir"  value="dist" />
        <property name="package.dir"  value="package" />

	<path id="compile.class.path">
		<pathelement location="${jsr173_api.jar}"/>
	</path>

	<target name="prepare">
                <tstamp>
                    <format property="TSTAMP" pattern="hhmmss"/>
                </tstamp>
		<mkdir dir="${build.dir}/classes"/>
		<mkdir dir="${dist.dir}"/>
		<mkdir dir="${package.dir}"/>
	</target>

	<target name="clean">
		<delete dir="${dist.dir}"/>
		<delete dir="${build.dir}/classes"/>
	</target>

	<target name="compile" depends="prepare">
		<javac source="1.4" srcdir="src" destdir="${build.dir}/classes"
			debug="on" optimize="on" deprecation="on">
			<classpath refid="compile.class.path"/>
		</javac>
	</target>

	<target name="dist" depends="compile">
		<jar jarfile="${dist.dir}/${app.jar}"
			basedir="${build.dir}/classes"/>
	</target>

	<target name="doc" depends="dist">
		<javadoc source="1.4"
                        sourcepath="src"
                        packagenames="com.sun.xml.fastinfoset.*"
			destdir="${dist.dir}/javadoc"
                        version="true">
                </javadoc>
	</target>

        <target name="package-contents" depends="doc">
            <copy todir="${package.dir}/${ant.project.name}_${version}_${DSTAMP}_${TSTAMP}">
                <fileset dir="dist">
                    <include name="javadoc/**"/>
                </fileset>
                <fileset dir="${basedir}">
                    <include name="README-PACKAGE.txt"/>
                    <include name="bin/*"/>
                    <include name="lib/*.jar"/>
                    <include name="${dist.dir}/${app.jar}"/>
                </fileset>
                <fileset dir="${basedir}/..">
                    <include name="LICENSE.txt"/>
                </fileset>
            </copy>
        </target>

        <target name="package" depends="package-contents">
            <zip destfile="${package.dir}/${ant.project.name}_${version}_${DSTAMP}_${TSTAMP}.zip">
                <fileset dir="${package.dir}">
                    <include name="${ant.project.name}_${version}_${DSTAMP}_${TSTAMP}/**"/>
                </fileset>                
            </zip>
        </target>

         <property name="wspack.home" value="fi-wspack" />

        <!-- target that would be invoked from wspack build -->
        <target name="wspack" depends="dist" >
            <mkdir dir="${wspack.home}" />
            <mkdir dir="${wspack.home}/lib" />
            <copy file="${dist.dir}/${app.jar}"
                todir="${wspack.home}/lib" />
        </target>

        
</project>
